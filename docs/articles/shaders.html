<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Shaders and Resources </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Shaders and Resources ">
    <meta name="generator" content="docfx 2.26.4.0">
    
    <link rel="shortcut icon" href="../favicon.ico">
    <link rel="stylesheet" href="../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../styles/docfx.css">
    <link rel="stylesheet" href="../styles/main.css">
    <meta property="docfx:navrel" content="../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
    
    
    
  </head>
  <body data-spy="scroll" data-target="#affix">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../index.html">
                <img id="logo" class="svg" src="../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="shaders-and-resources">
<h1 id="shaders-and-resources">Shaders and Resources</h1>

<p><a class="xref" href="../api/Veldrid.Shader.html">Shaders</a> are a fundamental device resource in Veldrid. Each Shader object represents a single shader module created from specialized shader code. Shader objects are combined into shader sets which are one input into a <a class="xref" href="../api/Veldrid.Pipeline.html">Pipeline</a>. Shaders can read from several other device resources while executing.</p>
<h2 id="creating-a-shader">Creating a Shader</h2>
<p>A <a class="xref" href="../api/Veldrid.ShaderDescription.html">ShaderDescription</a> takes two pieces of information. The first piece is the <a class="xref" href="../api/Veldrid.ShaderStages.html">stage</a> the shader is applicable to. The second piece of information is an API-specific byte array containing the shader code itself. The contents of this byte array depend on the specific graphics API being used (see <a class="xref" href="../api/Veldrid.GraphicsDevice.html#Veldrid_GraphicsDevice_BackendType">GraphicsDevice.BackendType</a>).</p>
<ul>
<li>Direct3D11: <code>ShaderBytes</code> must contain HLSL bytecode.</li>
<li>Vulkan: <code>ShaderBytes</code> must contain SPIR-V bytecode.</li>
<li>OpenGL: <code>ShaderBytes</code> must contain ASCII-encoded GLSL text.</li>
</ul>
<h2 id="shader-resources">Shader Resources</h2>
<p>Shader objects have a unique relationship with <a class="xref" href="../api/Veldrid.ResourceLayout.html">ResourceLayouts</a> and <a class="xref" href="../api/Veldrid.ResourceSet.html">ResourceSets</a>. When creating a Pipeline, the provided <a class="xref" href="../api/Veldrid.PipelineDescription.html#Veldrid_PipelineDescription_ResourceLayouts">ResourceLayouts</a> must match the actual resource types that are specified in the shader code.</p>
<p>ResourceLayouts merely define the layout of resources expected by a set of shaders. When draw commands are executed, the actual shader resources (Buffers, TextureViews, and Samplers) are determined based on the CommandList&#39;s currently-bound <a class="xref" href="../api/Veldrid.ResourceSet.html">ResourceSets</a>.</p>
<p>ResourceLayouts themselves contain a set of one-or-more resource elements. Additionally, multiple ResourceLayout objects can be used to define the inputs of a shader set. When this is done, each ResourceLayout must be matched by a corresponding ResourceSet containing the appropriate resource types. ResourceSet objects are bound to a particular slot. The slot corresponds to the index of the matching ResourceLayout given in the <a class="xref" href="../api/Veldrid.PipelineDescription.html#Veldrid_PipelineDescription_ResourceLayouts">ResourceLayouts</a> field of the PipelineDescription.</p>
<p>Generally, it is advisable to group resources into sets and layouts which are common or shared. For example, it is a good idea to group the camera&#39;s view and projection matrix, and other scene-level information, into a single ResourceLayout and shared ResourceSet. This allows many objects to be rendered using the same bound ResourceSet. Specific object Pipelines can utilize extra ResourceLayouts and ResourceSets to accomodate their specific rendering requirements while still utilizing shared resources when it makes sense. Changing ResourceSets can be a costly operation, so re-using them as much as possible can help performance.</p>
<h2 id="mapping-hlslglsl-resources-to-resourcelayouts">Mapping HLSL/GLSL resources to ResourceLayouts</h2>
<p>The layout system is convention-based, and relies on shader code being authored in a particular way for resource slots to match.</p>
<ul>
<li><p>Vulkan: ResourceLayouts match very closely with regular Vulkan conventions. In a Vulkan shader, a uniform&#39;s &quot;set&quot; layout specifies the ResourceLayout index in the overall <a class="xref" href="../api/Veldrid.PipelineDescription.html#Veldrid_PipelineDescription_ResourceLayouts">ResourceLayouts</a> array. The &quot;binding&quot; layout specifies the specific resource within that ResourceLayout identified by the &quot;set&quot;. For example:</p>
<pre><code>layout(set = 0, binding = 1) uniform View
</code></pre><p>defines a uniform belonging to binding 1 (of the <a class="xref" href="../api/Veldrid.ResourceLayoutDescription.html#Veldrid_ResourceLayoutDescription_Elements">ResourceLayoutElementDescription</a> array), of set 0 (of the <a class="xref" href="../api/Veldrid.PipelineDescription.html#Veldrid_PipelineDescription_ResourceLayouts">ResourceLayouts</a> array).</p>
</li>
<li><p>Direct3D 11: Resources are assigned HLSL registers based on their positions in the <a class="xref" href="../api/Veldrid.PipelineDescription.html#Veldrid_PipelineDescription_ResourceLayouts">ResourceLayouts</a> array first, and then by their position in the <a class="xref" href="../api/Veldrid.ResourceLayoutDescription.html#Veldrid_ResourceLayoutDescription_Elements">ResourceLayoutElementDescriptions</a> array. Each resource type (texture, sampler, uniform) is assigned an increasing integer value for its register number. For example, given these two ResourceLayouts:</p>
<p>  <strong>Layout 0</strong></p>
<table>
<thead>
<tr>
<th>Index</th>
<th>Type</th>
<th>Name</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>UniformBuffer</td>
<td>UB0</td>
</tr>
<tr>
<td>1</td>
<td>TextureView</td>
<td>Tex0</td>
</tr>
<tr>
<td>2</td>
<td>Sampler</td>
<td>Sampler0</td>
</tr>
<tr>
<td>3</td>
<td>Sampler</td>
<td>Sampler1</td>
</tr>
<tr>
<td>4</td>
<td>TextureView</td>
<td>Tex1</td>
</tr>
<tr>
<td>5</td>
<td>UniformBuffer</td>
<td>UB3</td>
</tr>
</tbody>
</table>
<p>  <strong>Layout 1</strong></p>
<table>
<thead>
<tr>
<th>Index</th>
<th>Type</th>
<th>Name</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>TextureView</td>
<td>Tex2</td>
</tr>
<tr>
<td>1</td>
<td>UniformBuffer</td>
<td>UB1</td>
</tr>
<tr>
<td>2</td>
<td>UniformBuffer</td>
<td>UB2</td>
</tr>
</tbody>
</table>
<p>  the HLSL resources must be specified as follows:</p>
<pre><code>cbuffer UB0 : register(b0) { ... }
cbuffer UB3 : register(b1) { ... }
cbuffer UB1 : register(b2) { ... }
cbuffer UB2 : register(b3) { ... }
Texture2D Tex0 : register(t0);
Texture2D Tex1 : register(t1);
Texture2D Tex2 : register(t2);
SamplerState Sampler0 : register(s0);
SamplerState Sampler1 : register(s1);
</code></pre><p>  (the declaration order is unimportant -- only the register indices matter).</p>
</li>
<li><p>OpenGL: Resources are matched strictly by-name. Each resource must correspond to a uniform or uniform block in the shader program, and the names must be identical. Numerical indices are ignored when matching resources to GLSL uniforms.</p>
</li>
</ul>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/mellinoe/veldrid-docs/blob/master/articles/shaders.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
             
            
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>
  </body>
</html>
